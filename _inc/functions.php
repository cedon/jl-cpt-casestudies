<?php

// Add a custom class to all meta boxes generated by plugin
function add_meta_box_class( $classes ) {
	array_push( $classes, 'jl-fitcase-meta');
	return $classes;
}

// Changes Upload Location for Client photos
function fitcase_client_photo_dir( $args ) {

	if ( isset( $_REQUEST['post_ID'] ) ) {

		$id        = $_REQUEST['post_ID'];
		$parent_id = get_post( $id )->post_parent;

		if ( "case_study" == get_post_type( $id ) || "case_study" == get_post_type( $parent_id ) ) {
			global $upload_array;
			$upload_loc = $upload_array;

			$args['subdir'] = $upload_loc['subdir'];
			$args['path'] = $upload_loc['path'];
			$args['url'] = $upload_loc['url'];
		}
	}

	return $args;
}
add_filter( 'upload_dir', 'fitcase_client_photo_dir' );

// Disables the Image Sizes for Uploading Images to prevent multiple versions
function fitcase_remove_image_sizes( $sizes, $metadata ) {

//	$sizes = array(
//		'thumbnail' => array(
//			'width'  => 150,
//			'height' => 150,
//			'crop'   => 1,
//		)
//	);
//	return $sizes;
	return [];
}

// Creates an array of all admin options that contain the string stored as JLFITCASE__NAMESPACE
function get_fitcase_options() {
	$all_options = wp_load_alloptions();
	$fitcase_options = array();

	foreach ( $all_options as $name => $value ) {
		if ( stristr( $name, JLFITCASE__NAMESPACE ) ) {
			$fitcase_options[ $name ] = $value;
		}
	}

	error_log( print_r( $fitcase_options, true ) );
}